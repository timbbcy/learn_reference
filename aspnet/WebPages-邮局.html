<div class="article-intro" id="content">
<h1>ASP.NET Web Pages <span class="color_h1">- WebMail 对象</span>
</h1>
<hr/>
<p class="intro">通过 WebMail 对象，您可以很容易地从网页上发送电子邮件。</p>
<hr/>
<h2>描述</h2>
<p><strong>WebMail 对象</strong>为 ASP.NET Web Pages 提供了使用 SMTP（Simple Mail Transfer Protocol 简单邮件传输协议）发送邮件的功能。</p>
<hr/>
<h2>实例</h2>
<p>请查看 <a href="webpages-email.html">WebPages Email</a> 章节中的实例。</p>
<hr/>
<h2>WebMail 对象参考手册 - 属性</h2>
<table class="reference notranslate">
<tr>
<th align="left" style="width:25%">属性</th>
<th align="left">描述</th>
</tr>
<tr>
<td valign="top">SmtpServer</td>
<td valign="top">用于发送电子邮件的 SMTP 服务器的名称。</td>
</tr>
<tr>
<td valign="top">SmtpPort</td>
<td valign="top">服务器用来发送 SMTP 电子邮件的端口。</td>
</tr>
<tr>
<td valign="top">EnableSsl</td>
<td valign="top">如果服务器使用 SSL（Secure Socket Layer 安全套接层）加密，则值为 true。</td>
</tr>
<tr>
<td valign="top">UserName</td>
<td valign="top">用于发送电子邮件的 SMTP 电子邮件账户的名称。</td>
</tr>
<tr>
<td valign="top">Password</td>
<td valign="top">SMTP 电子邮件账户的密码。</td>
</tr>
<tr>
<td valign="top">From</td>
<td valign="top">在发件地址栏显示的电子邮件（通常与 UserName 相同）。</td>
</tr>
</table>
<br/><hr/>
<h2>WebMail 对象参考手册 - 方法</h2>
<table class="reference notranslate">
<tr>
<th align="left" style="width:25%">方法</th>
<th align="left">描述</th>
</tr>
<tr>
<td valign="top">Send()</td>
<td valign="top">向 SMTP 服务器发送需要传送的电子邮件信息。</td>
</tr>
</table>
<p>Send() 方法有以下参数：</p>
<table class="reference notranslate">
<tr>
<th style="width:25%">参数</th>
<th style="width:25%">类型</th>
<th>描述</th>
</tr>
<tr>
<td>to</td>
<td>String</td>
<td>收件人（用分号分隔）</td>
</tr>
<tr>
<td>subject</td>
<td>String</td>
<td>邮件主题</td>
</tr>
<tr>
<td>body</td>
<td>String</td>
<td>邮件正文</td>
</tr>
</table>
<p>Send() 方法有以下可选参数：</p>
<table class="reference notranslate">
<tr>
<th style="width:25%">参数</th>
<th style="width:25%">类型</th>
<th>描述</th>
</tr>
<tr>
<td>from</td>
<td>String</td>
<td>发件人</td>
</tr>
<tr>
<td>cc</td>
<td>String</td>
<td>需要抄送的电子邮件地址（用分号分隔）</td>
</tr>
<tr>
<td>filesToAttach</td>
<td>Collection</td>
<td>附件名</td>
</tr>
<tr>
<td>isBodyHtml</td>
<td>Boolean</td>
<td>如果邮件正文是 HTML 格式的，则为 true</td>
</tr>
<tr>
<td>additionalHeaders</td>
<td>Collection</td>
<td>附加的标题</td>
</tr>
</table>
<br/><hr/>
<h2>技术数据</h2>
<table class="reference notranslate">
<tr>
<th style="width:25%">名称</th>
<th>值</th>
</tr>
<tr>
<td>Class</td>
<td>System.Web.Helpers.WebMail</td>
</tr>
<tr>
<td>Namespace</td>
<td>System.Web.Helpers</td>
</tr>
<tr>
<td>Assembly</td>
<td>System.Web.Helpers.dll</td>
</tr>
</table>
<br/><hr/>
<h2>初始化 WebMail 帮助器</h2>
<p>要使用 WebMail 帮助器，您必须能访问 SMTP 服务器。SMTP 是电子邮件的"输出"部分。如果您使用的是虚拟主机，您可能已经知道 SMTP 服务器的名称。如果您使用的是公司网络工作，您公司的 IT 部门会给您一个名称。如果您是在家工作，你也许可以使用普通的电子邮件服务提供商。</p>
<p>为了发送一封电子邮件，您将需要：</p>
<ul>
<li>SMTP 服务器的名称 </li>
<li>端口号（通常是 25 ）</li>
<li>电子邮件的用户名</li>
<li>电子邮件的密码</li>
</ul>
<p>在您的 Web 根目录下，创建一个名为 <strong>_AppStart.cshtml</strong> 的页面（如果已存在，则直接编辑页面）。</p>
<p>将下面的代码复制到文件中：</p>
<div class="example">
<h2 class="example">_AppStart.cshtml</h2>
<div class="example_code notranslate">
	@{<br/>WebMail.SmtpServer = "smtp.example.com";<br/>WebMail.SmtpPort = 25;<br/>
WebMail.EnableSsl = false;<br/>WebMail.UserName = "support@example.com";<br/>
WebMail.Password = "password";<br/>WebMail.From = "john@example.com"<br/>}
</div>
</div>
<p>上面的代码将在每次网站（应用程序）启动时运行。它对 <strong>WebMail 对象</strong>赋了初始值。</p>
<p>请替换：</p>
<p>将 <strong>smtp.example.com</strong> 替换成您要用来发送电子邮件的 SMTP 服务器的名称。</p>
<p>将 <strong>25</strong> 替换成服务器用来发送 SMTP 事务（电子邮件）的端口号。</p>
<p>如果服务器使用 SSL（Secure Socket Layer 安全套接层）加密，请将 <strong>false</strong> 替换成 true。</p>
<p>将 <strong>support@example.com</strong> 替换成用来发送电子邮件的 SMTP 电子邮件账户的名称。</p>
<p>将 <strong>password</strong> 替换成 SMTP 电子邮件账户的密码。</p>
<p>将 <strong>john@example </strong> 替换成显示在发件地址栏中的电子邮件。</p>
<table class="lamp"><tr>
<th width="34"><img alt="lamp" height="32" src="/images/lamp.jpg" width="32"/></th>
<td>
在您的 AppStart 文件中，您不需要启动 <strong>WebMail 对象</strong>，但是在调用 <strong>WebMail.Send()</strong> 方法之前，您必须设置这些属性。</td>
</tr></table>
<br/><br/>
</div>