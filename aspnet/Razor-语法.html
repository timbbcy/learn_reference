<div class="article-intro" id="content">
<h1>ASP.NET Razor <span class="color_h1">- C# 和 VB 代码语法</span>
</h1>
<hr/>
<p class="intro">Razor 同时支持 C# (C sharp) 和 VB (Visual Basic)。</p>
<hr/>
<h2>主要的 Razor C# 语法规则</h2>
<ul>
<li>Razor 代码块包含在 @{ ... } 中</li>
<li>内联表达式（变量和函数）以 @ 开头</li>
<li>代码语句用分号结束</li>
<li>变量使用 var 关键字声明</li>
<li>字符串用引号括起来</li>
<li>C# 代码区分大小写</li>
<li>C# 文件的扩展名是 .cshtml</li>
</ul>
<div class="example">
<h2 class="example">C# 实例</h2>
<div class="example_code notranslate">
&lt;!-- Single statement block --&gt;<br/><span class="marked">@{ var myMessage =	"Hello World"; }</span><br/><br/>
&lt;!-- Inline expression or variable --&gt;<br/>
&lt;p&gt;The value of myMessage is: <span class="marked">@myMessage</span>&lt;/p&gt; <br/><br/>
&lt;!--	Multi-statement block --&gt;<br/><span class="marked">@{<br/>
var greeting = "Welcome to our site!";<br/>
var weekDay = DateTime.Now.DayOfWeek;<br/>
var greetingMessage = greeting + " Here in Huston it is: " + weekDay;<br/>
}</span><br/>&lt;p&gt;The greeting is: <span class="marked">@greetingMessage</span>&lt;/p&gt;
</div>
<br/><a class="showbtn" href="/try/showfile_c.php?filename=try_razor_cs_001" target="_blank">	运行实例 »</a>
</div>
<br/><hr/>
<h2>主要的 Razor VB 语法规则</h2>
<ul>
<li>Razor 代码块包含在 @Code ... End Code 中</li>
<li>内联表达式（变量和函数）以 @ 开头</li>
<li>变量使用 Dim 关键字声明</li>
<li>字符串用引号括起来</li>
<li>VB 代码不区分大小写</li>
<li>VB 文件的扩展名是 .vbhtml</li>
</ul>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
&lt;!-- Single statement block  --&gt; <br/><span class="marked">@Code dim myMessage = "Hello World" End Code</span><br/>
<br/>
&lt;!-- Inline expression or variable --&gt; <br/>
&lt;p&gt;The value of myMessage is: <span class="marked">@myMessage</span>&lt;/p&gt; <br/>
<br/>
&lt;!-- Multi-statement block --&gt; <br/><span class="marked">@Code<br/>
dim greeting = "Welcome to our site!" <br/>
dim weekDay = DateTime.Now.DayOfWeek <br/>
dim greetingMessage = greeting &amp; " Here in Huston it is: " &amp; weekDay<br/>
End Code</span>
<br/><br/>
&lt;p&gt;The greeting is: <span class="marked">@greetingMessage</span>&lt;/p&gt;</div>
<br/><a class="showbtn" href="/try/showfile_c.php?filename=try_razor_vb_001" target="_blank">运行实例 »</a>
</div>
<br/><hr/>
<h2>它是如何工作的？</h2>
<p>Razor 是一种将服务器代码嵌入在网页中的简单的编程语法。</p>
<p>Razor 语法是基于 ASP.NET 框架，专门用于创建 Web 应用程序的部分 Microsoft.NET 框架。</p>
<p>Razor 语法支持所有 ASP.NET 的功能，但是使用的是一种简化语法，对初学者而言更容易学习，对专家而言更有效率的。</p>
<p>Razor 网页可以被描述成带以下两种类型内容的 HTML 网页：
HTML 内容和 Razor 代码。 </p>
<p>当服务器读取页面时，它首先运行 Razor 代码，然后再发送 HTML 页面到浏览器。在服务器上执行的代码能够执行一些在浏览器上不能完成的任务，比如，访问服务器数据库。服务器代码能创建动态的 HTML 内容，然后发送到浏览器。从浏览器上看，服务器代码生成的 HTML 与静态的 HTML 内容没有什么不同。</p>
<p>带 Razor 语法的 ASP.NET 网页有特殊的文件扩展名 cshtml（Razor C#）或者 vbhtml（Razor VB）。</p>
<hr/>
<h2>使用对象</h2>
<p>服务器编码往往涉及到对象。</p><p>"Date" 对象是一个典型的内置的 ASP.NET 对象，但对象也可以是自定义的，一个网页，一个文本框，一个文件，一个数据库记录，等等。</p><p>对象有用于执行的方法。一个数据库记录可能有一个 "Save" 方法，一个图像对象可能有一个 "Rotate" 方法，一个电子邮件对象可能有一个 "Send" 方法，等等。<br/>对象也有用于描述各自特点的属性。一个数据库记录可能有 FirstName 和 LastName 属性。</p>
<p>ASP.NET Date 对象有一个 Now 属性（写成 Date.Now），Now 属性有一个 Day 属性（写成 Date.Now.Day）。下面实例演示了如何访问 Date 对象的一些属性：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
&lt;table border="1"&gt;<br/>&lt;tr&gt;<br/>&lt;th 
width="100px"&gt;Name&lt;/th&gt;<br/>&lt;td width="100px"&gt;Value&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>&lt;tr&gt;<br/>&lt;td&gt;Day&lt;/td&gt;&lt;td&gt;<span class="marked">@DateTime.Now.Day</span>&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>&lt;tr&gt;<br/>&lt;td&gt;Hour&lt;/td&gt;&lt;td&gt;<span class="marked">@DateTime.Now.Hour</span>&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>&lt;tr&gt;<br/>&lt;td&gt;Minute&lt;/td&gt;&lt;td&gt;<span class="marked">@DateTime.Now.Minute</span>&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>&lt;tr&gt;<br/>&lt;td&gt;Second&lt;/td&gt;&lt;td&gt;<span class="marked">@DateTime.Now.Second</span>&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>&lt;/td&gt;<br/>&lt;/table&gt;</div>
<br/><a class="showbtn" href="/try/showfile_c.php?filename=try_razor_cs_002" target="_blank">	运行实例 »</a>
</div>
<br/><hr/>
<h2>If 和 Else条件</h2>
<p>动态网页的一个重要特点是，您可以根据条件决定做什么。</p>
<p>做到这一点的常用方法是使用 if ... else 语句：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
<span class="marked">@{<br/>var txt = "";<br/>if(DateTime.Now.Hour &gt; 12)<br/>  
{txt = "Good Evening";}<br/>else<br/>  {txt = "Good Morning";}<br/>}<br/></span>
&lt;html&gt;<br/>&lt;body&gt;<br/>&lt;p&gt;The message is <span class="marked">@txt</span>&lt;/p&gt;<br/>
&lt;/body&gt;<br/>&lt;/html&gt;<br/>
</div>
<br/><a class="showbtn" href="/try/showfile_c.php?filename=try_razor_cs_003" target="_blank">	运行实例 »</a>
</div>
<br/><hr/>
<h2>读取用户输入</h2>
<p>动态网页的另一个重要特点是，您可以读取用户输入。</p>
<p>输入是通过 Request[] 功能读取的，并且传送输入数据是经过 IsPost 条件判断的：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
<span class="marked">@{<br/>var totalMessage = "";<br/>if(IsPost)<br/>
   
{<br/>    var num1 = Request["text1"];<br/>
   
var num2 = Request["text2"];<br/>    var total = num1.AsInt() + num2.AsInt();<br/>    totalMessage = 
"Total = " + total;<br/>    }<br/>}</span><br/>&lt;html&gt;<br/>&lt;body 
style="background-color: beige; font-family: Verdana, Arial;"&gt;<br/>&lt;form 
action="" method="post"&gt;<br/>&lt;p&gt;&lt;label for="text1"&gt;First Number:&lt;/label&gt;&lt;br&gt;<br/>
&lt;input type="text" name="text1" /&gt;&lt;/p&gt;<br/>&lt;p&gt;&lt;label for="text2"&gt;Second 
Number:&lt;/label&gt;&lt;br&gt;<br/>&lt;input type="text" name="text2" /&gt;&lt;/p&gt;<br/>&lt;p&gt;&lt;input 
type="submit" value=" Add " /&gt;&lt;/p&gt;<br/>&lt;/form&gt;<br/>&lt;p&gt;<span class="marked">@totalMessage</span>&lt;/p&gt;<br/>
&lt;/body&gt;<br/>&lt;/html&gt;</div>
<br/><a class="showbtn" href="/try/showfile_c.php?filename=try_razor_cs_004" target="_blank">运行实例 »</a>
</div>
<br/>
</div>