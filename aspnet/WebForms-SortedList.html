<div class="article-intro" id="content">
<h1>ASP.NET Web Forms <span class="color_h1">- SortedList 对象</span>
</h1>
<hr/>
<p class="intro">SortedList 对象结合了 ArrayList 对象和 Hashtable 对象的特性。</p>
<hr/>
<div class="tryit_ex">
<img alt="Examples" height="46px" src="/images/tryitimg.gif" width="40"/><h2>尝试一下 - 实例</h2>
</div>
<p><a href="/try/showaspx.php?filename=demo_sortedlist_radio1" target="_blank">SortedList RadiobuttonList 1</a></p>
<p><a href="/try/showaspx.php?filename=demo_sortedlist_radio2" target="_blank">SortedList RadiobuttonList 2</a></p>
<p><a href="/try/showaspx.php?filename=demo_sortedlist_drop1" target="_blank">SortedList DropDownList</a></p>
<hr/>
<h2>SortedList 对象</h2>
<p>SortedList 对象包含用键/值对表示的项目。SortedList 对象按照字母顺序或者数字顺序自动地对项目进行排序。</p>
<p>通过 Add() 方法向 SortedList 添加项目。通过 TrimToSize() 方法把 SortedList 调整为最终尺寸。</p>
<p>下面的代码创建了一个名为 mycountries 的 SortedList 对象，并添加了四个元素：</p>
<div class="code notranslate"><div>

&lt;script runat="server"&gt;<br/>
sub Page_Load<br/>
if Not Page.IsPostBack then<br/>
   
  dim mycountries=New SortedList<br/>
   
  mycountries.Add("N","Norway")<br/>
   
  mycountries.Add("S","Sweden")<br/>
   
  mycountries.Add("F","France")<br/>
   
  mycountries.Add("I","Italy")<br/>
end if<br/>
end sub<br/>
&lt;/script&gt;</div></div>
<br/><hr/>
<h2>数据绑定</h2>
<p>SortedList 对象可为下列的控件自动生成文本和值：</p>
<ul>
<li>asp:RadioButtonList</li>
<li>asp:CheckBoxList</li>
<li>asp:DropDownList</li>
<li>asp:Listbox</li>
</ul>
<p>为了绑定数据到 RadioButtonList 控件，首先要在 .aspx 页面中创建一个 RadioButtonList 控件（不带任何 asp:ListItem 元素）：</p>
<div class="code notranslate"><div>

&lt;html&gt;<br/>
&lt;body&gt;<br/><br/>
&lt;form runat="server"&gt;<br/>
&lt;asp:RadioButtonList id="rb" runat="server"
AutoPostBack="True" /&gt;<br/>
&lt;/form&gt;<br/><br/>
&lt;/body&gt;<br/>
&lt;/html&gt;</div></div>
<p>然后添加创建列表的脚本，并且绑定列表中的值到 RadioButtonList 控件：</p>
<div class="code notranslate"><div>

&lt;script runat="server"&gt;<br/>
sub Page_Load<br/>
if Not Page.IsPostBack then<br/>
   
  dim mycountries=New SortedList<br/>
   
  mycountries.Add("N","Norway")<br/>
   
  mycountries.Add("S","Sweden")<br/>
   
  mycountries.Add("F","France")<br/>
   
  mycountries.Add("I","Italy")<br/>
   
  rb.DataSource=mycountries<br/>
   
  rb.DataValueField="Key"<br/>
   
  rb.DataTextField="Value"<br/>
   
  rb.DataBind()<br/>
end if<br/>
end sub<br/>
&lt;/script&gt;<br/><br/>
&lt;html&gt;<br/>
&lt;body&gt;<br/><br/>
&lt;form runat="server"&gt;<br/>
&lt;asp:RadioButtonList id="rb" runat="server"
AutoPostBack="True" /&gt;<br/>
&lt;/form&gt;<br/><br/>
&lt;/body&gt;<br/>
&lt;/html&gt;</div></div>
<p>然后我们添加一个子例程，当用户点击 RadioButtonList 控件中的某个项目时，该子例程会被执行。当某个单选按钮被点击时，label 中会出现一行文本：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
&lt;script runat="server"&gt;<br/>
sub Page_Load<br/>
if Not Page.IsPostBack then<br/>
  dim mycountries=New SortedList<br/>
  mycountries.Add("N","Norway")<br/>
  mycountries.Add("S","Sweden")<br/>
  mycountries.Add("F","France")<br/>
  mycountries.Add("I","Italy")<br/>
  rb.DataSource=mycountries<br/>
  rb.DataValueField="Key"<br/>
  rb.DataTextField="Value"<br/>
  rb.DataBind()<br/>
end if<br/>
end sub<br/><br/>
sub displayMessage(s as Object,e As EventArgs)<br/>
lbl1.text="Your favorite country is: " &amp; rb.SelectedItem.Text<br/>
end sub<br/>
&lt;/script&gt;<br/><br/>
&lt;html&gt;<br/>
&lt;body&gt;<br/><br/>
&lt;form runat="server"&gt;<br/>
&lt;asp:RadioButtonList id="rb" runat="server"<br/>
AutoPostBack="True" onSelectedIndexChanged="displayMessage" /&gt;<br/>
&lt;p&gt;&lt;asp:label id="lbl1" runat="server" /&gt;&lt;/p&gt;<br/>
&lt;/form&gt;<br/><br/>
&lt;/body&gt;<br/>
&lt;/html&gt;
</div>
<br/><a class="showbtn" href="/try/showaspx.php?filename=demo_sortedlist_radio1" target="_blank">演示实例 »</a>
</div>
<br/>
</div>