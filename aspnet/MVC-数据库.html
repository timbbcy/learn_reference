<div class="article-intro" id="content">
<h1>ASP.NET MVC <span class="color_h1">- SQL 数据库</span>
</h1>
<hr/>
<p class="intro">为了学习 ASP.NET MVC，我们将构建一个 Internet 应用程序。</p>
<p class="intro">第 6 部分：添加数据库。</p>
<hr/>
<h2>创建数据库</h2>
<p>Visual Web Developer 带有名为 SQL Server Compact 免费的 SQL 数据库。</p>
<p>本教程所需的这个数据库可以通过以下几个简单的步骤来创建：</p>
<ul>
<li>右击 <strong>Solution Explorer</strong> 窗口中的 <strong>App_Data</strong> 文件夹</li>
<li>选择 <strong>Add, New Item</strong>
</li>
<li>选择 <strong>SQL Server Compact Local Database *</strong>
</li>
<li>将数据库命名为
	<strong>Movies.sdf</strong></li>
<li>点击 <strong>Add</strong> 按钮</li>
</ul>
<p><strong>*</strong> 如果选项中没有 SQL Server Compact Local Database，则说明您尚未在计算机上安装 SQL Server Compac。请通过以下链接进行安装：<a href="http://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0">SQL 
Server Compact</a></p>
<p>Visual Web Developer 会自动在 App_Data 文件夹中创建该数据库。
</p>
<p><strong>注释：</strong>在本教程中，需要您掌握一些关于 SQL 数据库的基础知识。如果您想先学习这个主题，请访问我们的 <a href="#">SQL 教程</a>。</p>
<hr/>
<h2>添加数据库表</h2>
<p>双击 <strong>App_Data</strong> 文件夹中的 <strong>Movies.sdf</strong> 文件，将打开 <strong>Database Explorer</strong> 窗口。</p>
<p>如需在数据库中创建一个新的表，请右击 <strong>Tables</strong> 文件夹，然后选择 <strong>Create Table</strong>。 </p>
<p>创建如下的列：</p>
<table class="reference notranslate" style="width: 100%">
<tr>
<th>列</th>
<th>类型</th>
<th>是否允许为 Null</th>
</tr>
<tr>
<td>ID</td>
<td>int (primary key)</td>
<td>No</td>
</tr>
<tr>
<td>Title</td>
<td>nvarchar(100)</td>
<td>No</td>
</tr>
<tr>
<td>Director</td>
<td>nvarchar(100)</td>
<td>No</td>
</tr>
<tr>
<td>Date</td>
<td>datetime</td>
<td>No</td>
</tr>
</table>
<p>对列的解释：</p>
<p><strong>ID</strong> 是用于标识表中每条记录的整数（全数字）。</p>
<p><strong>Title</strong> 是 100 个字符长度的文本列，用于存储影片的名称。</p>
<p><strong>Director</strong> 是 100 个字符长度的文本列，用于存储导演的名字。</p>
<p><strong>Date</strong> 是日期列，用于存储影片的发布日期。</p>
<p>在创建好上述列之后，您必须将 ID 列设置为表的主键（记录标识符）。要做到这点，请点击列名（ID），并选择 <strong>Primary Key</strong>。在 <strong>
Column Properties</strong> 窗口中，设置 <strong>Identity</strong> 属性为 <strong>
True</strong>：</p>
<p><img alt="DB Explorer" height="543" src="/wp-content/uploads/2013/08/pic_mvc_dbexplorer.jpg" width="615"/></p>
<p>当您创建好表列后，保存表并命名为 <strong>MovieDBs</strong>。</p>
<p><strong>注释：</strong></p>
<p>我们特意把表命名为 "MovieDBs"（以 s 结尾）。在下一章中，您将看到用于数据模型的 "MovieDB"。这看起来有点奇怪，不过这种命名惯例能确保控制器连接上数据库表，您必须这么使用。</p>
<hr/>
<h2>添加数据库记录</h2>
<p>您可以使用 Visual Web Developer 向 movie 数据库中添加一些测试记录。</p>
<p>双击 <strong>App_Data</strong> 文件夹中的 <strong>Movies.sdf</strong> 文件。</p>
<p>右击 Database Explorer 窗口中的 <strong>MovieDBs</strong> 表，并选择 <strong>Show Table Data</strong>。</p>
<p>添加一些记录：</p>
<table class="reference notranslate" style="width: 100%">
<tr>
<th>ID</th>
<th>Title</th>
<th>Director</th>
<th>Date</th>
</tr>
<tr>
<td>1</td>
<td>Psycho</td>
<td>Alfred Hitchcock</td>
<td>01.01.1960</td>
</tr>
<tr>
<td>2 </td>
<td>La Dolce Vita</td>
<td>Federico Fellini</td>
<td>01.01.1960</td>
</tr>
</table>
<p><strong>注释：</strong>ID 列会自动更新，您可以不用编辑它。</p>
<hr/>
<h2>添加连接字符串</h2>
<p>向您的 <strong>Web.config</strong> 文件中的 <strong>&lt;connectionStrings&gt;</strong> 元素添加如下元素：</p>
<div class="code notranslate">
<div class="auto-style1">&lt;add name="MovieDBContext"<br/>connectionString="Data 
	Source=|DataDirectory|Movies.sdf"<br/>providerName="System.Data.SqlServerCe.4.0"/&gt;</div>
</div>
<br/><br/>
</div>