<div class="article-intro" id="content">
<h1>ASP.NET Web Pages <span class="color_h1">- 文件</span>
</h1>
<hr/>
<p class="intro">本章介绍有关使用文本文件的知识。</p>
<hr/>
<h2>使用文本文件</h2>
<p>在前面的章节中，我们已经了解到网页数据是存储在数据库中的。</p>
<p>您也可以把站点数据存储在文本文件中。</p>
<p>用来存储数据的文本文件通常被称为平面文件。常见的文本文件格式是 .txt、.xml 和 .csv（逗号分隔值）。</p>
<p><strong>在本章中，您将学习到：</strong></p>
<ul>
<li>如何从文本文件中读取并显示数据</li>
</ul>
<hr/>
<h2>手动添加一个文本文件</h2>
<p>在下面的例子中，您将需要一个文本文件。</p>
<p>在您的网站上，如果没有 App_Data 文件夹，请创建一个。在 App_Data 文件夹中，创建一个名为 Persons.txt 的文件。</p>
<p>添加以下内容到文件中：</p>
<div class="example">
<h2 class="example">Persons.txt</h2>
<div class="example_code notranslate">
George,Lucas<br/>
Steven,Spielberg<br/>
Alfred,Hitchcock</div>
</div>
<br/><hr/>
<h2>显示文本文件中的数据</h2>
<p>下面的实例演示了如何显示一个文本文件中的数据：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
<span class="marked">@{<br/>var dataFile = Server.MapPath("~/App_Data/Persons.txt");<br/>
	Array userData = File.ReadAllLines(dataFile);<br/>}<br/><br/></span>&lt;!DOCTYPE 
	html&gt;<br/>&lt;html&gt;<br/>&lt;body&gt;<br/><br/>&lt;h1&gt;Reading Data from a File&lt;/h1&gt;<br/><span class="marked">@foreach (string dataLine in userData) <br/>{<br/>  foreach 
	(string dataItem in dataLine.Split(',')) <br/>  {@dataItem &lt;text&gt;&amp;nbsp;&lt;/text&gt;}</span><br/>  
	&lt;br /&gt;<br/><span class="marked">}</span><br/>&lt;/body&gt;<br/>&lt;/html&gt;
</div>
<br/><a class="showbtn" href="/try/showfile_c.php?filename=try_webpages_cs_019" target="_blank">运行实例 »</a>
</div>
<h2>实例解释</h2>
<p>使用 <strong>Server.MapPath</strong> 找到确切的文本文件的路径。</p>
<p>使用 <strong>File.ReadAllLines</strong> 打开文本文件，并读取文件中的所有行到一个数组中。</p>
<p>数组中的每个<strong>数据行</strong>中的<strong>数据项</strong>的数据被显示。</p>
<hr/>
<h2>显示 Excel 文件中的数据</h2>
<p>使用 Microsoft Excel，您可以将一个电子表格保存为一个逗号分隔的文本文件（.csv 文件）。此时，电子表格中的每一行保存为一个文本行，每个数据列由逗号分隔。</p>
<p>你可以使用上面的实例读取一个 Excel .csv 文件（只需将文件名改成相应的 Excel 文件的名称）。</p>
<br/>
</div>