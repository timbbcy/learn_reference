<div class="article-intro">
<h2>本节引言：</h2>
<blockquote><p>在多媒体的第一节，我们用SoundPool写了个Duang的示例，小猪点击一个按钮后，突然发出"Duang"的
一声，而且当时的声音很大，吓死宝宝了<img alt="" src="http://www.runoob.com/wp-content/uploads/2015/10/75690406.jpg"/>，好在不是上班时间，上班时间偷偷写博客给经理知道
会作死的~嗯，好的，说到这个声音大小就得介绍下Android为我们提供的(音量大小控制)的API：</p><p>
<strong>AudioManager(音频管理器)</strong>了，该类位于Android.Media包下，提供了音量控制与铃声模式相关操作！
本节我们就来学下这个东东的用法，你可以写一个Demo，一个简单的静音，每次看小电影之前，先
进Demo点下静音，然后<img alt="" src="http://www.runoob.com/wp-content/uploads/2015/10/59360078.jpg"/>，说说而已哈~嗯，话不多说，开始本节内容！</p><p>
官方API文档：<a href="http://androiddoc.qiniudn.com/reference/android/media/AudioManager.html">AudioManager</a></p></blockquote>
<hr/>
<h2>1.获得AudioManager对象实例</h2>
<blockquote><p><strong>AudioManager audiomanage = (AudioManager)context.getSystemService(Context.AUDIO_SERVICE);</strong></p></blockquote>
<hr/>
<h2>2.相关方法详解</h2>
<p><strong>常用方法</strong>：</p>
<blockquote><ul>
<li><strong>adjustVolume</strong>(int direction, int flags)：
控制手机音量,调大或者调小一个单位,根据第一个参数进行判断
<strong>AudioManager.ADJUST_LOWER</strong>,可调小一个单位;
<strong>AudioManager.ADJUST_RAISE</strong>,可调大一个单位</li>
<li><strong>adjustStreamVolume</strong>(int streamType, int direction, int flags)：
同上,不过可以选择调节的声音类型
1）streamType参数,指定声音类型,有下述几种声音类型:
<strong>STREAM_ALARM</strong>：手机闹铃           <strong>STREAM_MUSIC</strong>：手机音乐        <br/>
<strong>STREAM_RING</strong>：电话铃声          <strong>STREAM_SYSTEAM</strong>：手机系统      <br/>
<strong>STREAM_DTMF</strong>：音调              <strong>STREAM_NOTIFICATION</strong>：系统提示<br/>
<strong>STREAM_VOICE_CALL</strong>:语音电话
2）第二个参数和上面那个一样,调大或调小音量的
3）可选的标志位,比如AudioManager.<strong>FLAG_SHOW_UI</strong>,显示进度条,AudioManager.<strong>PLAY_SOUND</strong>:播放声音</li>
<li><strong>setStreamVolume</strong>(int streamType, int index, intflags)：直接设置音量大小</li>
<li><strong>getMode</strong>( )：返回当前的音频模式</li>
<li><strong>setMode</strong>( )：设置声音模式
有下述几种模式:
<strong>MODE_NORMAL</strong>(普通), <strong>MODE_RINGTONE</strong>(铃声),
<strong>MODE_IN_CALL</strong>(打电话)，<strong>MODE_IN_COMMUNICATION</strong>(通话)</li>
<li><strong>getRingerMode</strong>( )：返回当前的铃声模式</li>
<li><strong>setRingerMode</strong>(int streamType):设置铃声模式
有下述几种模式:
如<strong>RINGER_MODE_NORMAL</strong>（普通）、<strong>RINGER_MODE_SILENT</strong>（静音）、<strong>RINGER_MODE_VIBRATE</strong>（震动）</li>
<li><strong>getStreamVolume</strong>(int streamType)：
获得手机的当前音量,最大值为7,最小值为0,当设置为0的时候,会自动调整为震动模式</li>
<li><strong>getStreamMaxVolume</strong>(int streamType)：获得手机某个声音类型的最大音量值</li>
<li><strong>setStreamMute</strong>(int streamType,boolean state)：将手机某个声音类型设置为静音</li>
<li><strong>setSpeakerphoneOn</strong>(boolean on)：设置是否打开扩音器</li>
<li><strong>setMicrophoneMute</strong>(boolean on)：设置是否让麦克风静音</li>
<li><strong>isMicrophoneMute</strong>()：判断麦克风是否静音或是否打开</li>
<li><strong>isMusicActive</strong>()：判断是否有音乐处于活跃状态</li>
<li><strong>isWiredHeadsetOn</strong>()：判断是否插入了耳机</li>
</ul>
</blockquote>
<p><strong>其他方法</strong>：</p>
<blockquote><ul>
<li><strong>abandonAudioFocus</strong>(AudioManager.OnAudioFocusChangeListenerl)：放弃音频的焦点</li>
<li><strong>adjustSuggestedStreamVolume</strong>(int,int suggestedStreamType intflags)：
调整最相关的流的音量，或者给定的回退流</li>
<li><strong>getParameters</strong>(String keys)：给音频硬件设置一个varaible数量的参数值</li>
<li><strong>getVibrateSetting</strong>(int vibrateType)：返回是否该用户的振动设置为振动类型</li>
<li><strong>isBluetoothA2dpOn</strong>()：检查是否A2DP蓝牙耳机音频路由是打开或关闭</li>
<li><strong>isBluetoothScoAvailableOffCall</strong>()：显示当前平台是否支持使用SCO的关闭调用用例</li>
<li><strong>isBluetoothScoOn</strong>()：检查通信是否使用蓝牙SCO</li>
<li><strong>loadSoundEffects</strong>()：加载声音效果</li>
<li><strong>playSoundEffect</strong>((int effectType, float volume)：播放声音效果</li>
<li><strong>egisterMediaButtonEventReceiver</strong>(ComponentName eventReceiver)：
注册一个组件MEDIA_BUTTON意图的唯一接收机</li>
<li><strong>requestAudioFocus</strong>(AudioManager.OnAudioFocusChangeListener l,int streamType,int durationHint)
请求音频的焦点</li>
<li><strong>setBluetoothScoOn</strong>(boolean on)：要求使用蓝牙SCO耳机进行通讯</li>
<li><strong>startBluetoothSco/stopBluetoothSco()</strong>()：启动/停止蓝牙SCO音频连接</li>
<li><strong>unloadSoundEffects</strong>()：卸载音效</li>
</ul>
</blockquote>
<hr/>
<h2>3.使用示例</h2>
<blockquote><p>嘿嘿，属性蛮多的，有些还涉及到蓝牙这些东东，这里我们只讲解最常见的一些方法！</p><p>
遇到一些特殊的没见过的，我们再来查文档！</p><p>
简单的示例：使用Mediaplayer播放音乐,通过AudioManager调节音量大小与静音！</p><p>
对了，先在res下创建一个raw的文件夹，往里面丢一个MP3资源文件！</p></blockquote>
<p><strong>运行效果图</strong>：</p>
<p><img alt="" src="http://www.runoob.com/wp-content/uploads/2015/10/22065922.jpg"/></p>
<p><strong>代码实现</strong>：</p>
<p>布局代码<strong>activity_main.xml</strong>：</p>
<pre>
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"&gt;

    &lt;Button
        android:id="@+id/btn_start"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="播放" /&gt;

    &lt;Button
        android:id="@+id/btn_stop"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:enabled="false"
        android:text="停止" /&gt;

    &lt;Button
        android:id="@+id/btn_higher"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="调高音量" /&gt;

    &lt;Button
        android:id="@+id/btn_lower"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="调低音量" /&gt;

    &lt;Button
        android:id="@+id/btn_quite"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="静音" /&gt;

&lt;/LinearLayout&gt; 
</pre>
<p><b>MainActivity.java</b>：</p>
<pre>
public class MainActivity extends AppCompatActivity implements View.OnClickListener {

    private Button btn_start;
    private Button btn_stop;
    private Button btn_higher;
    private Button btn_lower;
    private Button btn_quite;
    private MediaPlayer mePlayer;
    private AudioManager aManager;
    //定义一个标志用来标示是否点击了静音按钮
    private int flag = 1;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //获得系统的音频对象
        aManager = (AudioManager) getSystemService(Service.AUDIO_SERVICE);
        //初始化mediaplayer对象,这里播放的是raw文件中的mp3资源
        mePlayer = MediaPlayer.create(MainActivity.this, R.raw.countingstars);
        //设置循环播放:
        mePlayer.setLooping(true);
        bindViews();
    }

    private void bindViews() {
        btn_start = (Button) findViewById(R.id.btn_start);
        btn_stop = (Button) findViewById(R.id.btn_stop);
        btn_higher = (Button) findViewById(R.id.btn_higher);
        btn_lower = (Button) findViewById(R.id.btn_lower);
        btn_quite = (Button) findViewById(R.id.btn_quite);

        btn_start.setOnClickListener(this);
        btn_stop.setOnClickListener(this);
        btn_higher.setOnClickListener(this);
        btn_lower.setOnClickListener(this);
        btn_quite.setOnClickListener(this);
    }

    @Override
    public void onClick(View v) {
        switch (v.getId()) {
            case R.id.btn_start:
                btn_stop.setEnabled(true);
                mePlayer.start();
                btn_start.setEnabled(false);
                break;
            case R.id.btn_stop:
                btn_start.setEnabled(true);
                mePlayer.pause();
                btn_stop.setEnabled(false);
                break;
            case R.id.btn_higher:
                // 指定调节音乐的音频，增大音量，而且显示音量图形示意
                aManager.adjustStreamVolume(AudioManager.STREAM_MUSIC,
                        AudioManager.ADJUST_RAISE, AudioManager.FLAG_SHOW_UI);
                break;
            case R.id.btn_lower:
                // 指定调节音乐的音频，降低音量，只有声音,不显示图形条
                aManager.adjustStreamVolume(AudioManager.STREAM_MUSIC,
                        AudioManager.ADJUST_LOWER, AudioManager.FLAG_PLAY_SOUND);
                break;
            case R.id.btn_quite:
                // 指定调节音乐的音频，根据isChecked确定是否需要静音
                flag *= -1;
                if (flag == -1) {
                    aManager.setStreamMute(AudioManager.STREAM_MUSIC, true);   //API 23过期- -
//                    aManager.adjustStreamVolume(AudioManager.STREAM_MUSIC, AudioManager.ADJUST_MUTE,
//                            AudioManager.FLAG_SHOW_UI);   //23以后的版本用这个
                    btn_quite.setText("取消静音");
                } else {
                    aManager.setStreamMute(AudioManager.STREAM_MUSIC, false);//API 23过期- -
//                    aManager.adjustStreamVolume(AudioManager.STREAM_MUSIC, AudioManager.ADJUST_UNMUTE,
//                            AudioManager.FLAG_SHOW_UI);  //23以后的版本用这个
                    aManager.setMicrophoneMute(false);
                    btn_quite.setText("静音");
                }
                break;
        }
    }
}
</pre>
<p>代码还是非常简单的，另外设置静音的方法<strong>setStreamMute</strong>()在API 23版本过期，
可以使用另一个方法adjustStreamVolume(int, int, int)，然后第三个属性设置：</p><p>
<strong>ADJUST_MUTE</strong> 或 <strong>ADJUST_UNMUTE</strong>！</p><p>
对了，还有：</p><p>
如果<strong>adjustStreamVolume</strong>()的第三个参数你设置了振动(Vibrator),
需要在AndroidManifest.xml中添加这个权限哦!</p>
<pre>
&lt;**uses-permission android:name="android.permission.VIBRATE"**/&gt;
</pre>
<hr/>
<h2>4.代码示例下载</h2>
<p><a href="http://static.runoob.com/download/AudioManagerDemo.zip">AudioManagerDemo.zip</a></p>
<hr/>
<h2>本节小结：</h2>
<blockquote><p>好的，本节给大家演示了AudioManager用于调节音量的一个简单用法，这个类笔者也不常用
到，以后如果有什么新get的技能再加上吧~嘿嘿，静音Demo写好没？要结合实际需求哈~<img alt="" src="http://www.runoob.com/wp-content/uploads/2015/10/68214403.jpg"/></p><p>
另外，本周博客可能不会更新得太频繁，本周要把公司的WebSocket库替换掉，有得头痛了~
好的，就说这么多，谢谢~</p></blockquote> </div>