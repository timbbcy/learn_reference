<div class="article-intro" id="content">
<h1>ASP <span class="color_h1">Browser Capabilities</span> 组件</h1>
<hr/>
<h2>ASP Browser Capabilities 组件</h2>
<p>ASP Browser Capabilities 组件会创建一个 BrowserType 对象，这个对象可测定访客浏览器的类型、性能和版本号。</p>
<p>当浏览器连接到服务器时，就会向服务器发送一个 HTTP User Agent 报头。这个报头包含关于浏览器的信息。</p>
<p>BrowserType 对象会把报头中的信息与服务器上名为 "Browscap.ini" 的文件中的信息作比较。</p>
<p>如果报头中的浏览器类型和版本号与 "Browsercap.ini" 文件中信息匹配，那么我们就可以使用 BrowserType 对象列出这个匹配的浏览器的相关属性。如果上述情况不匹配，这个对象会把每个属性设置为 "UNKNOWN"。</p>
<h3>语法</h3>
<div class="code notranslate"><div>

&lt;%<br/>
Set MyBrow=Server.CreateObject("MSWC.BrowserType")<br/>
%&gt;</div></div>
<br/><hr/>
<h2>ASP Browser Capabilities 实例</h2>
<p>下面的实例会在 ASP 文件中创建一个 BrowserType 对象，并显示当前浏览器性能的一些信息：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
	&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>
&lt;body&gt;<br/>
&lt;%<br/>
Set MyBrow=Server.CreateObject("MSWC.BrowserType")<br/>
%&gt;<br/><br/>
&lt;table border="0" width="100%"&gt;<br/>
&lt;tr&gt;<br/>
&lt;th&gt;Client OS&lt;/th&gt;&lt;th&gt;&lt;%=MyBrow.platform%&gt;&lt;/th&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td &gt;Web Browser&lt;/td&gt;&lt;td &gt;&lt;%=MyBrow.browser%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td&gt;Browser version&lt;/td&gt;&lt;td&gt;&lt;%=MyBrow.version%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td&gt;Frame support?&lt;/td&gt;&lt;td&gt;&lt;%=MyBrow.frames%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td&gt;Table support?&lt;/td&gt;&lt;td&gt;&lt;%=MyBrow.tables%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td&gt;Sound support?&lt;/td&gt;&lt;td&gt;&lt;%=MyBrow.backgroundsounds%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td&gt;Cookies support?&lt;/td&gt;&lt;td&gt;&lt;%=MyBrow.cookies%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td&gt;VBScript support?&lt;/td&gt;&lt;td&gt;&lt;%=MyBrow.vbscript%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;&lt;tr&gt;<br/>
&lt;td&gt;JavaScript support?&lt;/td&gt;&lt;td&gt;&lt;%=MyBrow.javascript%&gt;&lt;/td&gt;<br/>
&lt;/tr&gt;<br/>
&lt;/table&gt;<br/><br/>
&lt;/body&gt;<br/>
&lt;/html&gt;
</div>
<p>输出：</p>
<div class="example_result notranslate">
<table style="width:100%;border:0">
<tr style="text-align:left">
<th>Client OS</th>
<th>WinNT</th>
</tr>
<tr>
<td>Web Browser</td>
<td>IE</td>
</tr>
<tr>
<td>Browser version</td>
<td>5.0</td>
</tr>
<tr>
<td>Frame support?</td>
<td>True</td>
</tr>
<tr>
<td>Table support?</td>
<td>True</td>
</tr>
<tr>
<td>Sound support?</td>
<td>True</td>
</tr>
<tr>
<td>Cookies support?</td>
<td>True</td>
</tr>
<tr>
<td>VBScript support?</td>
<td>True</td>
</tr>
<tr>
<td>JavaScript support?</td>
<td>True</td>
</tr>
</table>
</div>
<br/><a class="showbtn" href="/try/showasp.php?filename=demo_browsercap" target="_blank">演示实例 »</a>
</div>
<hr/>
<h2>Browscap.ini 文件</h2>
<p>"Browscap.ini" 文件用于声明属性，并设置各浏览器的默认值。</p>
<p>这部分内容不是关于如何维护 Browscap.ini 文件的教程，我们只提供一些关于 "Browsercap.ini" 的基础知识和概念，让您对该文件有个大概的了解。</p>
<p>"Browscap.ini" 文件可包含下面的信息：</p>
<div class="code notranslate"><div>

[;comments]<br/>
[HTTPUserAgentHeader]<br/>
[parent=browserDefinition]<br/>
[property1=value1]<br/>
[propertyN=valueN]<br/>
[Default Browser Capability Settings]<br/>
[defaultProperty1=defaultValue1]<br/>
[defaultPropertyN=defaultValueN]</div></div>
<br/><table class="reference notranslate">
<tr valign="top">
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
<tr valign="top">
<td>comments</td>
<td>可选项。任何起始于分号的代码行都被 BrowserType 对象忽略。</td>
</tr>
<tr valign="top">
<td>HTTPUserAgentHeader</td>
<td>可选项。规定与在 propertyN 中设定的 browser-property 值声明相关的 HTTP User Agent 报头。允许使用通配符。</td>
</tr>
<tr valign="top">
<td>browserDefinition</td>
<td>可选项。规定作为父浏览器使用的某个浏览器的 HTTP User Agent header-string。当前浏览器的定义会继承在父浏览器的定义中所有声明过的属性值。</td>
</tr>
<tr valign="top">
<td>propertyN</td>
<td>可选项。规定浏览器的属性。下面的表格列出了某些可能的属性： <ul>
<li>ActiveXControls - 支持 ActiveX® 控件？</li>
<li>Backgroundsounds - 支持背景声音？</li>
<li>Cdf - 支持针对网络广播的频道定义格式？</li>
<li>Tables - 支持表格？</li>
<li>Cookies - 支持 cookies？</li>
<li>Frames - 支持框架？</li>
<li>Javaapplets - 支持 Java applets？</li>
<li>Javascript - 支持 JScript？</li>
<li>Vbscript - 支持 VBScript？</li>
<li>Browser - 规定浏览器的名称</li>
<li>Beta - 浏览器是否为 beta 软件？</li>
<li>Platform - 规定浏览器运行的平台</li>
<li>Version - 规定浏览器的版本号</li>
</ul>
</td>
</tr>
<tr valign="top">
<td>valueN</td>
<td>可选项。规定 propertyN 的值。可为字符串、整数（前缀带 #）或者布尔值。</td>
</tr>
<tr valign="top">
<td>defaultPropertyN</td>
<td>可选项。规定浏览器属性的名称，假如已定义的 HTTPUserAgentHeader 值中没有值能与浏览器发送的 HTTP User Agent 报头相匹配，则为这个属性分配一个默认的值。</td>
</tr>
<tr valign="top">
<td>defaultValueN</td>
<td>可选项。规定 defaultPropertyN 的值。可为字符串、整数（前缀带 #）或者布尔值。</td>
</tr>
</table>
<p>"Browscap.ini" 文件可能如下所示：</p>
<div class="code notranslate"><div>

;IE 5.0<br/>
[IE 5.0]<br/>
browser=IE<br/>
Version=5.0<br/>
majorver=#5<br/>
minorver=#0<br/>
frames=TRUE<br/>
tables=TRUE<br/>
cookies=TRUE<br/>
backgroundsounds=TRUE<br/>
vbscript=TRUE<br/>
javascript=TRUE<br/>
javaapplets=TRUE<br/>
ActiveXControls=TRUE<br/>
beta=False<br/><br/>
;DEFAULT BROWSER<br/>
[*]<br/>
browser=Default<br/>
frames=FALSE<br/>
tables=TRUE<br/>
cookies=FALSE<br/>
backgroundsounds=FALSE<br/>
vbscript=FALSE<br/>
javascript=FALSE</div></div>
<br/>
</div>