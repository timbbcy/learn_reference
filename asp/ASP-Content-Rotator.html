<div class="article-intro" id="content">
<h1>ASP <span class="color_h1">Content Rotator</span> 组件 (ASP 3.0)</h1>
<hr/>
<h2>ASP Content Rotator 组件</h2>
<p>ASP Content Rotator 组件创建一个 ContentRotator 对象，每当访客进入网站或刷新页面时，该对象就会显示一段不同的内容字符串。</p>
<p>有关内容字符串的信息是包含在一个名为内容目录文件（Content Schedule File）的文本文件中。</p>
<p>内容字符串可包含 HTML 标签，这样您就可以显示 HTML 可呈现的任何类型的内容：文本、图像、颜色或者超链接。</p>
<h3>语法</h3>
<div class="code notranslate"><div>

&lt;%<br/>
Set cr=Server.CreateObject("MSWC.ContentRotator")<br/>
%&gt;</div></div>
<br/><hr/>
<h2>ASP Content Rotator 实例</h2>
<p>每当访客浏览网页时，下面的实例就会显示不同的内容。</p>
<p>首先，创建一个名为 "textads.txt" 的文本文件，并把它放置在名为 "text" 的子文件夹中。</p>
<p>"textads.txt":</p>
<div class="code notranslate"><div>

%% #3 <br/>
&lt;h2&gt;This is a great day!!&lt;/h2&gt;<br/><br/>
%% #3<br/>
&lt;img src="smiley.gif"&gt;<br/><br/>
%% #4<br/>
&lt;a href="http://www.runoob.com"&gt;Visit RUNOOB&lt;/a&gt;</div></div>
<p>请注意在每个内容字符串起始位置的 # 号码。这个号码是一个可选的参数，用来指示 HTML 内容字符串的相对权重。在上面的文本文件中，Content Rotator 有十分之三的几率显示第一个内容字符串，有十分之三的几率显示第二个内容字符串，有十分之四的几率显示第三个字符串。</p>
<p>然后，创建一个 ASP 文件，并插入下面的代码：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code notranslate">
&lt;html&gt;<br/>
&lt;body&gt;<br/>
&lt;%<br/>
set cr=server.createobject("MSWC.ContentRotator")<br/>
response.write(cr.ChooseContent("text/textads.txt"))<br/>
%&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;
</div>
<br/><a class="showbtn" href="/try/showasp.php?filename=demo_contentrotator" target="_blank">演示实例 »</a>
</div>
<br/><hr/>
<h2>ASP Content Rotator 组件的方法</h2>
<table class="reference notranslate">
<tr valign="top">
<th align="left" width="15%">方法</th>
<th align="left" width="35%">描述</th>
<th align="left" width="50%">实例</th>
</tr>
<tr valign="top">
<td>ChooseContent</td>
<td>获取并显示某个内容字符串。</td>
<td>&lt;%<br/>
    dim cr<br/>
    Set cr=Server.CreateObject("MSWC.ContentRotator") <br/>
      response.write(cr.ChooseContent("text/textads.txt"))<br/>
    %&gt;<p>输出：<br/><br/><img alt="Smiley" src="/wp-content/uploads/2013/08/smiley.gif"/></p>
</td>
</tr>
<tr valign="top">
<td>GetAllContent</td>
<td>取回并显示文本文件中所有的内容字符串。</td>
<td> &lt;%<br/>
    dim cr<br/>
    Set cr=Server.CreateObject("MSWC.ContentRotator") <br/>
      response.write(cr.GetAllContent("text/textads.txt"))<br/>
    %&gt;
    <p>输出：</p>
<h2>This is a great day!!</h2>
<p><img alt="Smiley" src="/wp-content/uploads/2013/08/smiley.gif"/></p>
<p><a href="http://www.runoob.com">Visit RUNOOB</a></p>
</td>
</tr>
</table>
<br/>
</div>