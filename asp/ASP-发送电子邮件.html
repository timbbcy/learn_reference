<div class="article-intro" id="content">
<h1>ASP <span class="color_h1">使用 CDOSYS</span> <span class="color_h1">发送电子邮件</span>
</h1>
<hr/>
<p class="intro">CDOSYS 是 ASP 中的内建组件。此组件用于通过 ASP 发送电子邮件。</p>
<hr/>
<h2>使用 CDOSYS 发送电子邮件</h2>
<p>CDO (Collaboration Data Objects) 是一项微软的技术，设计目的是用来简化通讯应用程序的创建。</p>
<p>CDOSYS 是 ASP 中的内建组件。我们将向您演示如何通过 ASP 使用该组件来发送电子邮件。</p>
<h2>CDONTs 怎么样？</h2>
<p>微软已经在 Windows 2000、Windows XP 和 Windows 2003 中淘汰了 CDONTs。如果您已经在您的 ASP 应用程序中使用 CDONTs，那么您需要更新代码，并使用新的 CDO 技术。</p>
<h2>使用 CDOSYS 的实例</h2>
<p>发送文本电子邮件：</p>
<div class="code notranslate"><div>

&lt;%<br/>
Set myMail=CreateObject("CDO.Message")<br/>
myMail.Subject="Sending email with CDO"<br/>
myMail.From="mymail@mydomain.com"<br/>
myMail.To="someone@somedomain.com"<br/>
myMail.TextBody="This is a message."<br/>
myMail.Send<br/>
set myMail=nothing<br/>
%&gt;</div></div>
<p>发送带有 Bcc 和 CC 字段的文本电子邮件：</p>
<div class="code notranslate"><div>

&lt;%<br/>
Set myMail=CreateObject("CDO.Message")<br/>
myMail.Subject="Sending email with CDO"<br/>
myMail.From="mymail@mydomain.com"<br/>
myMail.To="someone@somedomain.com"<br/>
myMail.Bcc="someoneelse@somedomain.com"<br/>
myMail.Cc="someoneelse2@somedomain.com"<br/>
myMail.TextBody="This is a message."<br/>
myMail.Send<br/>
set myMail=nothing<br/>
%&gt;</div></div>
<p>发送 HTML 电子邮件：</p>
<div class="code notranslate"><div>

&lt;%<br/>
Set myMail=CreateObject("CDO.Message")<br/>
myMail.Subject="Sending email with CDO"<br/>
myMail.From="mymail@mydomain.com"<br/>
myMail.To="someone@somedomain.com"<br/>
myMail.HTMLBody = "&lt;h1&gt;This is a message.&lt;/h1&gt;"<br/>
myMail.Send<br/>
set myMail=nothing<br/>
%&gt;</div></div>
<p>发送一封内容为某个网站的某个网页的 HTML 电子邮件：</p>
<div class="code notranslate"><div>

&lt;%<br/>
Set myMail=CreateObject("CDO.Message")<br/>
myMail.Subject="Sending email with CDO"<br/>
myMail.From="mymail@mydomain.com"<br/>
myMail.To="someone@somedomain.com"<br/>
myMail.CreateMHTMLBody "http://www.w3cschool.cc/asp/"<br/>
myMail.Send<br/>
set myMail=nothing<br/>
%&gt;</div></div>
<p>发送一封内容为您的计算机中某个文件的某个网页的 HTML 电子邮件：</p>
<div class="code notranslate"><div>

&lt;%<br/>
Set myMail=CreateObject("CDO.Message")<br/>
myMail.Subject="Sending email with CDO"<br/>
myMail.From="mymail@mydomain.com"<br/>
myMail.To="someone@somedomain.com"<br/>
myMail.CreateMHTMLBody "file://c:/mydocuments/test.htm"<br/>
myMail.Send<br/>
set myMail=nothing<br/>
%&gt;</div></div>
<p>发送一封带有附件的文本电子邮件：</p>
<div class="code notranslate"><div>

&lt;%<br/>
Set myMail=CreateObject("CDO.Message")<br/>
myMail.Subject="Sending email with CDO"<br/>
myMail.From="mymail@mydomain.com"<br/>
myMail.To="someone@somedomain.com"<br/>
myMail.TextBody="This is a message."<br/>
myMail.AddAttachment "c:mydocumentstest.txt"<br/>
myMail.Send<br/>
set myMail=nothing<br/>
%&gt;</div></div>
<p>使用远程服务器发送一封文本电子邮件：</p>
<div class="code notranslate"><div>

&lt;%<br/>
Set myMail=CreateObject("CDO.Message")<br/>
myMail.Subject="Sending email with CDO"<br/>
myMail.From="mymail@mydomain.com"<br/>
myMail.To="someone@somedomain.com"<br/>
myMail.TextBody="This is a message."<br/>
myMail.Configuration.Fields.Item _<br/>
("http://schemas.microsoft.com/cdo/configuration/sendusing")=2<br/>
'Name or IP of remote SMTP server<br/>
myMail.Configuration.Fields.Item _<br/>
("http://schemas.microsoft.com/cdo/configuration/smtpserver")="smtp.server.com"<br/>
'Server port<br/>
myMail.Configuration.Fields.Item _<br/>
("http://schemas.microsoft.com/cdo/configuration/smtpserverport")=25 <br/>
myMail.Configuration.Fields.Update<br/>
myMail.Send<br/>
set myMail=nothing<br/>
%&gt;</div></div>
<br/>
</div>