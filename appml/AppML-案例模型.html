<div class="article-intro" id="content">
<h1>
<span class="color_h1">&lt;AppML&gt; </span>案例研究 - 应用程序模型</h1>
<hr/>
<p class="intro">此案例研究演示了如何构建一个完整的 &lt;AppML&gt; 互联网应用程序，具有针对数据库中的若干表进行信息列举、编辑和搜索的功能。</p>
<hr/>
<h2>应用程序模型</h2>
<p>在本章中，我们将为数据库中的 Customers 表建立一个完整的应用程序模型。</p>
<hr/>
<h2>&lt;AppML&gt; 过滤器</h2>
<p>如需允许过滤 &lt;AppML&gt; 数据，只需简单地向模型添加一个 &lt;filters&gt; 元素：
</p>
<div class="example">
<h2 class="example">实例：</h2>
<div class="example_code notranslate">
	&lt;filters&gt;<br/>&lt;query&gt;<br/>  &lt;field label="Customer"&gt;CustomerName&lt;/field&gt;<br/>  
	&lt;field&gt;City&lt;/field&gt;<br/>  &lt;field&gt;Country&lt;/field&gt;<br/>&lt;/query&gt;<br/>
	&lt;order&gt;<br/>  &lt;field label="Customer"&gt;CustomerName&lt;/field&gt;<br/>  
	&lt;field&gt;City&lt;/field&gt;<br/>  &lt;field&gt;Country&lt;/field&gt;<br/>&lt;/order&gt;<br/>
	&lt;/filters&gt;
</div>
</div>
<p>如需全面了解，请参阅 &lt;AppML&gt; <a href="appml-reference.html">参考手册</a>。</p>
<hr/>
<h2>&lt;AppML&gt; 更新</h2>
<p>如需允许更新 &lt;AppML&gt; 数据，只需简单地向模型添加一个 &lt;update&gt; 元素：
</p>
<div class="example">
<h2 class="example">实例：</h2>
<div class="example_code notranslate">&lt;update&gt;<br/>
 
&lt;item&gt;&lt;name&gt;LastName&lt;/name&gt;&lt;/item&gt;<br/>
 
&lt;item&gt;&lt;name&gt;FirstName&lt;/name&gt;&lt;/item&gt;<br/>  &lt;item&gt;&lt;name&gt;BirthDate&lt;/name&gt;&lt;/item&gt;<br/>
 
&lt;item&gt;&lt;name&gt;Photo&lt;/name&gt;&lt;/item&gt;<br/>  &lt;item&gt;&lt;name&gt;Notes&lt;/name&gt;&lt;/item&gt;<br/>
&lt;/update&gt;
</div>
</div>
<p>且向 &lt;database&gt; 元素添加一个 &lt;maintable&gt; 和 &lt;keyfield&gt; 元素：
</p>
<div class="example">
<h2 class="example">实例：</h2>
<div class="example_code notranslate">&lt;maintable&gt;Customers&lt;/maintable&gt;<br/>&lt;keyfield&gt;CustomerID&lt;/keyfield&gt;
</div>
</div>
<p>如需全面了解，请参阅 &lt;AppML&gt; <a href="appml-reference.html">参考手册</a>。</p>
<hr/>
<h2>&lt;AppML&gt; 安全</h2>
<p>您可以通过向 &lt;AppML&gt; 标签添加一个 security 属性来很容易地为 &lt;AppML&gt; 模型添加安全。</p>
<div class="example">
<h2 class="example">实例：</h2>
<div class="example_code notranslate">
	&lt;appml 
	<strong><span class="marked">security="admin"</span></strong>&gt;<br/><br/>
</div>
</div>
<p>
在上面的实例中，只有用户登录成为用户组 "admin" 的会员才能访问模型。</p>
<p>如需为 &lt;update&gt; 元素设置安全，只需简单地向 &lt;update&gt; 元素添加一个 security 属性：</p>
<div class="example">
<h2 class="example">实例：</h2>
<div class="example_code notranslate">
	&lt;update 
	<strong><span class="marked">security="admin"</span></strong>&gt;<br/>
 
&lt;item&gt;&lt;name&gt;LastName&lt;/name&gt;&lt;/item&gt;<br/>
 
&lt;item&gt;&lt;name&gt;FirstName&lt;/name&gt;&lt;/item&gt;<br/>  &lt;item&gt;&lt;name&gt;BirthDate&lt;/name&gt;&lt;/item&gt;<br/>
 
&lt;item&gt;&lt;name&gt;Photo&lt;/name&gt;&lt;/item&gt;<br/>  &lt;item&gt;&lt;name&gt;Notes&lt;/name&gt;&lt;/item&gt;<br/>
	&lt;/update&gt;</div>
</div>
<br/><hr/>
<h2>完整的 Customers 模型</h2>
<p>在本章中，我们将为数据库中的每个表设立一个应用程序模型。</p>
<p>创建一个名为 Models 的新文件夹。在 Models 文件夹中，为每个应用程序创建一个模型。</p>
<div class="example">
<h2 class="example">模型：Customers.xml</h2>
<div class="example_code notranslate">
	&lt;appml security=""&gt;<br/><br/>&lt;datasource&gt;<br/>&lt;database&gt;<br/>  &lt;connection&gt;Demo&lt;/connection&gt;<br/>
	 
	&lt;maintable&gt;Customers&lt;/maintable&gt;<br/>  &lt;keyfield&gt;CustomerID&lt;/keyfield&gt;<br/>  &lt;sql&gt;SELECT * FROM Customers&lt;/sql&gt;<br/>
	 
	&lt;orderby&gt;CustomerName,City,Country&lt;/orderby&gt;<br/>&lt;/database&gt;<br/>&lt;/datasource&gt;<br/><br/>&lt;filters&gt;<br/>&lt;query&gt;<br/>  &lt;field label="Customer"&gt;CustomerName&lt;/field&gt;<br/>
	 
	&lt;field&gt;City&lt;/field&gt;<br/>  &lt;field&gt;Country&lt;/field&gt;<br/>&lt;/query&gt;<br/>&lt;order&gt;<br/>
	 
	&lt;field label="Customer"&gt;CustomerName&lt;/field&gt;<br/>  &lt;field&gt;City&lt;/field&gt;<br/>
	 
	&lt;field&gt;Country&lt;/field&gt;<br/>&lt;/order&gt;<br/>&lt;/filters&gt;<br/><br/>&lt;update security="admin"&gt;<br/>  &lt;item&gt;&lt;name&gt;CustomerName&lt;/name&gt;&lt;/item&gt;<br/>
	 
	&lt;item&gt;&lt;name&gt;ContactName&lt;/name&gt;&lt;/item&gt;<br/>  &lt;item&gt;&lt;name&gt;Address&lt;/name&gt;&lt;/item&gt;<br/>
	 
	&lt;item&gt;&lt;name&gt;PostalCode&lt;/name&gt;&lt;/item&gt;<br/>  &lt;item&gt;&lt;name&gt;City&lt;/name&gt;&lt;/item&gt;<br/>
	 
	&lt;item&gt;&lt;name&gt;Country&lt;/name&gt;&lt;/item&gt;<br/>&lt;/update&gt;<br/><br/>&lt;/appml&gt;
</div>
<br/>
</div>
<br/><hr/>
<h2>模型视图</h2>
<p>创建一个模型视图，把它保存为 Demo_Model.html，并尝试一下：</p>
<div class="example">
<h2 class="example">视图：Demo_Model.htm</h2>
<div class="example_code notranslate">
	&lt;h1&gt;Customers&lt;/h1&gt;<br/>&lt;div id="List01"&gt;&lt;/div&gt;<br/><br/>&lt;script src="appml.js"&gt;&lt;/script&gt;<br/>
	&lt;script&gt;<br/>customers=new 
	AppML("appml.htmlx","Models/Customers");<br/>customers.run("List01");<br/>&lt;/script&gt;</div>
<br/><a class="tryitbtn" href="/try/try.php?filename=Demo_Model" target="_blank">尝试一下 »</a>
</div>
<br/><hr/>
<h2>现在把所有的合并在一起</h2>
<p>然后，通过少量 JavaScript 编码，为所有模型创建一个测试页面：</p>
<div class="example">
<h2 class="example">Demo_Model_Views.htm</h2>
<div class="example_code notranslate">
	&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>&lt;link rel="stylesheet" 
	href="appml.css" /&gt;<br/>&lt;/head&gt;<br/><br/>&lt;body&gt;<br/>&lt;h1&gt;Demo Applications&lt;/h1&gt;<br/><br/>&lt;button onclick='myOpen("Customers")'&gt;Customers&lt;/button&gt;<br/>&lt;button 
	onclick='myOpen("Products")'&gt;Products&lt;/button&gt;<br/>&lt;button 
	onclick='myOpen("Suppliers")'&gt;Suppliers&lt;/button&gt;<br/>&lt;button 
	onclick='myOpen("Shippers")'&gt;Shippers&lt;/button&gt;<br/>&lt;button 
	onclick='myOpen("Categories")'&gt;Categories&lt;/button&gt;<br/>&lt;button 
	onclick='myOpen("Employees")'&gt;Employees&lt;/button&gt;<br/>&lt;button 
	onclick='myOpen("Orders")'&gt;Orders&lt;/button&gt;<br/>&lt;button 
	onclick='myOpen("OrderDetails")'&gt;OrderDetails&lt;/button&gt;<br/>&lt;br&gt;&lt;br&gt;<br/><br/>&lt;div id="Place01"&gt;&lt;/div&gt;<br/><br/>&lt;script src="appml.js"&gt;&lt;/script&gt;<br/>
	&lt;script&gt;<br/>function myOpen(pname)<br/>{<br/>var app_obj<br/>app_obj=new 
	AppML("appml.php","Models/" + pname);<br/>app_obj.run("Place01");<br/>}<br/>
	&lt;/script&gt;<br/><br/>&lt;/body&gt;<br/>&lt;/html&gt;</div>
<br/><a class="tryitbtn" href="/try/try.php?filename=Demo_Model_Views" target="_blank">显示结果 »</a>
</div>
<br/><br/>
</div>