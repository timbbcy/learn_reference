<div class="article-intro" id="content">
<h1>Swift 泛型</h1>
<p>Swift 提供了泛型让你写出灵活且可重用的函数和类型。</p>
<p>Swift 标准库是通过泛型代码构建出来的。</p>
<p>Swift 的数组和字典类型都是泛型集。</p>
<p>你可以创建一个Int数组，也可创建一个String数组，或者甚至于可以是任何其他 Swift 的类型数据数组。</p>
<p>以下实例是一个非泛型函数 exchange 用来交换两个 Int 值：</p>
<div class="example">
<h2 class="example_head">实例</h2>
<div class="example_code">
<div class="hl-main"><span class="hl-comment">// 定义一个交换两个变量的函数</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">swapTwoInts</span><span class="hl-brackets">(</span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">a</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">Int</span><span class="hl-code">, </span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">b</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">Int</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">let</span><span class="hl-code"> </span><span class="hl-identifier">temporaryA</span><span class="hl-code"> = </span><span class="hl-identifier">a</span><span class="hl-code">
</span><span class="hl-identifier">a</span><span class="hl-code"> = </span><span class="hl-identifier">b</span><span class="hl-code">
</span><span class="hl-identifier">b</span><span class="hl-code"> = </span><span class="hl-identifier">temporaryA</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">numb1</span><span class="hl-code"> = </span><span class="hl-number">100</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">numb2</span><span class="hl-code"> = </span><span class="hl-number">200</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">交换前数据: </span><span class="hl-special">\</span><span class="hl-string">(numb1) 和 </span><span class="hl-special">\</span><span class="hl-string">(numb2)</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">swapTwoInts</span><span class="hl-brackets">(</span><span class="hl-code">&amp;</span><span class="hl-identifier">numb1</span><span class="hl-code">, &amp;</span><span class="hl-identifier">numb2</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">交换后数据: </span><span class="hl-special">\</span><span class="hl-string">(numb1) 和 </span><span class="hl-special">\</span><span class="hl-string">(numb2)</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span></div>
</div>
</div>
<p>以上程序执行输出结果为：</p>
<pre>
交换前数据: 100 和 200
交换后数据: 200 和 100
</pre>
<p>以上实例只试用与交换整数 Int 类型的变量。如果你想要交换两个 String 值或者 Double 值，就得重新写个对应的函数，例如 swapTwoStrings(_:_:) 和 swapTwoDoubles(_:_:)，如下所示：</p>
<div class="example">
<h2 class="example_head">String 和 Double 值交换函数</h2>
<div class="example_code">
<div class="hl-main"><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">swapTwoStrings</span><span class="hl-brackets">(</span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">a</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-code">, </span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">b</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">String</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">let</span><span class="hl-code"> </span><span class="hl-identifier">temporaryA</span><span class="hl-code"> = </span><span class="hl-identifier">a</span><span class="hl-code">
</span><span class="hl-identifier">a</span><span class="hl-code"> = </span><span class="hl-identifier">b</span><span class="hl-code">
</span><span class="hl-identifier">b</span><span class="hl-code"> = </span><span class="hl-identifier">temporaryA</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">swapTwoDoubles</span><span class="hl-brackets">(</span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">a</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">Double</span><span class="hl-code">, </span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">b</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">Double</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">let</span><span class="hl-code"> </span><span class="hl-identifier">temporaryA</span><span class="hl-code"> = </span><span class="hl-identifier">a</span><span class="hl-code">
</span><span class="hl-identifier">a</span><span class="hl-code"> = </span><span class="hl-identifier">b</span><span class="hl-code">
</span><span class="hl-identifier">b</span><span class="hl-code"> = </span><span class="hl-identifier">temporaryA</span><span class="hl-code">
</span><span class="hl-brackets">}</span></div>
</div>
</div>
<p>从以上代码来看，它们功能代码是相同的，只是类型上不一样，这时我们可以使用泛型，从而避免重复编写代码。</p>
<p>
泛型使用了占位类型名（在这里用字母 T 来表示）来代替实际类型名（例如 Int、String 或 Double）。</p>
<pre>
func swapTwoValues&lt;T&gt;(_ a: inout T, _ b: inout T)
</pre>
<p>swapTwoValues 后面跟着占位类型名（T），并用尖括号括起来（<code>&lt;T&gt;</code>）。这个尖括号告诉 Swift 那个 T 是 swapTwoValues(_:_:) 函数定义内的一个占位类型名，因此 Swift 不会去查找名为 T 的实际类型。</p>
<p>以下实例是一个泛型函数 exchange 用来交换两个 Int 和 String 值：</p>
<div class="example">
<h2 class="example_head">实例</h2>
<div class="example_code">
<div class="hl-main"><span class="hl-comment">// 定义一个交换两个变量的函数</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">swapTwoValues</span><span class="hl-code">&lt;</span><span class="hl-identifier">T</span><span class="hl-code">&gt;</span><span class="hl-brackets">(</span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">a</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-code">, </span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">b</span><span class="hl-code">: </span><span class="hl-identifier">inout</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">let</span><span class="hl-code"> </span><span class="hl-identifier">temporaryA</span><span class="hl-code"> = </span><span class="hl-identifier">a</span><span class="hl-code">
</span><span class="hl-identifier">a</span><span class="hl-code"> = </span><span class="hl-identifier">b</span><span class="hl-code">
</span><span class="hl-identifier">b</span><span class="hl-code"> = </span><span class="hl-identifier">temporaryA</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">numb1</span><span class="hl-code"> = </span><span class="hl-number">100</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">numb2</span><span class="hl-code"> = </span><span class="hl-number">200</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">交换前数据:  </span><span class="hl-special">\</span><span class="hl-string">(numb1) 和 </span><span class="hl-special">\</span><span class="hl-string">(numb2)</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">swapTwoValues</span><span class="hl-brackets">(</span><span class="hl-code">&amp;</span><span class="hl-identifier">numb1</span><span class="hl-code">, &amp;</span><span class="hl-identifier">numb2</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">交换后数据: </span><span class="hl-special">\</span><span class="hl-string">(numb1) 和 </span><span class="hl-special">\</span><span class="hl-string">(numb2)</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">str1</span><span class="hl-code"> = </span><span class="hl-quotes">"</span><span class="hl-string">A</span><span class="hl-quotes">"</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">str2</span><span class="hl-code"> = </span><span class="hl-quotes">"</span><span class="hl-string">B</span><span class="hl-quotes">"</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">交换前数据:  </span><span class="hl-special">\</span><span class="hl-string">(str1) 和 </span><span class="hl-special">\</span><span class="hl-string">(str2)</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">swapTwoValues</span><span class="hl-brackets">(</span><span class="hl-code">&amp;</span><span class="hl-identifier">str1</span><span class="hl-code">, &amp;</span><span class="hl-identifier">str2</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">交换后数据: </span><span class="hl-special">\</span><span class="hl-string">(str1) 和 </span><span class="hl-special">\</span><span class="hl-string">(str2)</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span></div>
</div>
</div>
<p>以上程序执行输出结果为：</p>
<pre>
交换前数据:  100 和 200
交换后数据: 200 和 100
交换前数据:  A 和 B
交换后数据: B 和 A
</pre>
<hr/>
<h2>泛型类型</h2>
<p>Swift 允许你定义你自己的泛型类型。</p>
<p>自定义类、结构体和枚举作用于任何类型，如同 Array 和 Dictionary 的用法。</p>
<p>接下来我们来编写一个名为 Stack （栈）的泛型集合类型，栈只允许在集合的末端添加新的元素（称之为入栈），且也只能从末端移除元素（称之为出栈）。</p>
<p><img src="http://www.runoob.com/wp-content/uploads/2015/11/stackPushPop_2x.png"/></p>
<p>图片中从左到右解析如下：</p>
<ul>
<li>三个值在栈中。</li>
<li>第四个值被压入到栈的顶部。</li>
<li>现在有四个值在栈中，最近入栈的那个值在顶部。</li>
<li>栈中最顶部的那个值被移除，或称之为出栈。</li>
<li>移除掉一个值后，现在栈又只有三个值了。</li>
</ul>
<p>以下实例是一个非泛型版本的栈，以 Int 型的栈为例：</p>
<div class="example">
<h2 class="example_head">Int 型的栈</h2>
<div class="example_code">
<div class="hl-main"><span class="hl-types">struct</span><span class="hl-code"> </span><span class="hl-identifier">IntStack</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">items</span><span class="hl-code"> = </span><span class="hl-brackets">[</span><span class="hl-identifier">Int</span><span class="hl-brackets">]</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">mutating</span><span class="hl-code"> </span><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">item</span><span class="hl-code">: </span><span class="hl-identifier">Int</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">items</span><span class="hl-code">.</span><span class="hl-identifier">append</span><span class="hl-brackets">(</span><span class="hl-identifier">item</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-identifier">mutating</span><span class="hl-code"> </span><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">pop</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> -&gt; </span><span class="hl-identifier">Int</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">items</span><span class="hl-code">.</span><span class="hl-identifier">removeLast</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span></div>
</div>
</div>
<p>这个结构体在栈中使用一个名为 items 的 Array 属性来存储值。Stack 提供了两个方法：push(_:) 和 pop()，用来向栈中压入值以及从栈中移除值。这些方法被标记为 mutating，因为它们需要修改结构体的 items 数组。
</p><p>
上面的 IntStack 结构体只能用于 Int 类型。不过，可以定义一个泛型 Stack 结构体，从而能够处理任意类型的值。
</p><p>
下面是相同代码的泛型版本：</p>
<div class="example">
<h2 class="example_head">泛型的栈</h2>
<div class="example_code">
<div class="hl-main"><span class="hl-types">struct</span><span class="hl-code"> </span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-identifier">Element</span><span class="hl-code">&gt; </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">items</span><span class="hl-code"> = </span><span class="hl-brackets">[</span><span class="hl-identifier">Element</span><span class="hl-brackets">]</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">mutating</span><span class="hl-code"> </span><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-identifier">_</span><span class="hl-code"> </span><span class="hl-identifier">item</span><span class="hl-code">: </span><span class="hl-identifier">Element</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">items</span><span class="hl-code">.</span><span class="hl-identifier">append</span><span class="hl-brackets">(</span><span class="hl-identifier">item</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-identifier">mutating</span><span class="hl-code"> </span><span class="hl-identifier">func</span><span class="hl-code"> </span><span class="hl-identifier">pop</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> -&gt; </span><span class="hl-identifier">Element</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">items</span><span class="hl-code">.</span><span class="hl-identifier">removeLast</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">stackOfStrings</span><span class="hl-code"> = </span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-identifier">String</span><span class="hl-code">&gt;</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">字符串元素入栈: </span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">stackOfStrings</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">google</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">stackOfStrings</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">runoob</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-identifier">stackOfStrings</span><span class="hl-code">.</span><span class="hl-identifier">items</span><span class="hl-brackets">)</span><span class="hl-code">;
 
</span><span class="hl-identifier">let</span><span class="hl-code"> </span><span class="hl-identifier">deletetos</span><span class="hl-code"> = </span><span class="hl-identifier">stackOfStrings</span><span class="hl-code">.</span><span class="hl-identifier">pop</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">出栈元素: </span><span class="hl-quotes">"</span><span class="hl-code"> + </span><span class="hl-identifier">deletetos</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">var</span><span class="hl-code"> </span><span class="hl-identifier">stackOfInts</span><span class="hl-code"> = </span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-identifier">Int</span><span class="hl-code">&gt;</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">整数元素入栈: </span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">stackOfInts</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">stackOfInts</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-number">2</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-identifier">print</span><span class="hl-brackets">(</span><span class="hl-identifier">stackOfInts</span><span class="hl-code">.</span><span class="hl-identifier">items</span><span class="hl-brackets">)</span><span class="hl-code">;</span></div>
</div>
</div>
<p>实例执行结果为：</p>
<pre>
字符串元素入栈: 
["google", "runoob"]
出栈元素: runoob
整数元素入栈: 
[1, 2]
</pre>
<p>Stack 基本上和 IntStack 相同，占位类型参数 Element 代替了实际的 Int 类型。</p>
<p>以上实例中 Element 在如下三个地方被用作占位符：</p>
<ul>
<li>创建 <b>items</b> 属性，使用 <b>Element</b> 类型的空数组对其进行初始化。</li>
<li>指定 <b>push(_:)</b> 方法的唯一参数 <b>item</b> 的类型必须是 <b>Element</b> 类型。</li>
<li>指定 <b>pop()</b> 方法的返回值类型必须是 <b>Element</b> 类型。</li>
</ul>
<hr/>
<h2>扩展泛型类型</h2>
<p>当你扩展一个泛型类型的时候（使用 extension 关键字），你并不需要在扩展的定义中提供类型参数列表。更加方便的是，原始类型定义中声明的类型参数列表在扩展里是可以使用的，并且这些来自原始类型中的参数名称会被用作原始定义中类型参数的引用。</p>

下面的例子扩展了泛型类型 Stack，为其添加了一个名为 topItem 的只读计算型属性，它将会返回当前栈顶端的元素而不会将其从栈中移除：</div>