<div class="article-intro" id="content">
<h1>MongoDB 备份(mongodump)与恢复(mongorestore)</h1>
<hr/>
<h2>MongoDB数据备份</h2>
<p>在Mongodb中我们使用mongodump命令来备份MongoDB数据。该命令可以导出所有数据到指定目录中。</p>
<p> mongodump命令可以通过参数指定导出的数据量级转存的服务器。</p>
<h3>语法</h3>
<p>mongodump命令脚本语法如下：
</p>
<pre>
&gt;mongodump -h dbhost -d dbname -o dbdirectory
</pre>
<ul>
<li><strong>
-h：</strong><p>MongDB所在服务器地址，例如：127.0.0.1，当然也可以指定端口号：127.0.0.1:27017
</p></li><li><strong>
-d：</strong><p>需要备份的数据库实例，例如：test
</p></li><li><strong>
-o：</strong><p>备份的数据存放位置，例如：c:\data\dump，当然该目录需要提前建立，在备份完成后，系统自动在dump目录下建立一个test目录，这个目录里面存放该数据库实例的备份数据。
</p></li></ul>
<h3>实例</h3>
<p>在本地使用 27017 启动你的mongod服务。打开命令提示符窗口，进入MongoDB安装目录的bin目录输入命令mongodump:</p>
<pre>
&gt;mongodump
</pre>
<p>执行以上命令后，客户端会连接到ip为 127.0.0.1 端口号为 27017 的MongoDB服务上，并备份所有数据到 bin/dump/ 目录中。命令输出结果如下：
</p>
<p>
<img alt="MongoDB数据备份" src="http://www.runoob.com/wp-content/uploads/2013/12/mongodump.png"/>
</p>
<p>mongodump 命令可选参数列表如下所示：</p>
<table class="reference">
<tbody><tr><th style="width:40%">语法</th><th style="width:30%">描述</th><th>实例</th></tr>
<tr><td>mongodump --host HOST_NAME --port PORT_NUMBER</td><td>该命令将备份所有MongoDB数据</td><td>mongodump --host runoob.com --port 27017</td></tr>
<tr><td>mongodump --dbpath DB_PATH --out BACKUP_DIRECTORY</td><td></td><td>mongodump --dbpath /data/db/ --out /data/backup/</td></tr>
<tr><td>mongodump --collection COLLECTION --db DB_NAME</td><td>该命令将备份指定数据库的集合。</td><td>mongodump --collection mycol --db test</td></tr>
</tbody></table>
<hr/><h2>
MongoDB数据恢复</h2>
<p>mongodb使用 mongorestore 命令来恢复备份的数据。</p>
<h3>语法</h3>
<p>mongorestore命令脚本语法如下：
</p>
<pre>
&gt;mongorestore -h &lt;hostname&gt;&lt;:port&gt; -d dbname &lt;path&gt;
</pre>
<ul>
<li><strong>
--host <hostname>&lt;:port&gt;, -h <hostname>&lt;:port&gt;：</hostname></hostname></strong><p>MongoDB所在服务器地址，默认为： localhost:27017
</p></li><li><strong>
--db <database>, -d <database>：</database></database></strong><p>需要恢复的数据库实例，例如：test，当然这个名称也可以和备份时候的不一样，比如test2
</p></li><li><strong>
--drop：</strong><p>恢复的时候，先删除当前数据，然后恢复备份的数据。就是说，恢复后，备份后添加修改的数据都会被删除，慎用哦！</p></li>
<li><strong>
&lt;path&gt;：</strong><p> mongorestore 最后的一个参数，设置备份数据所在位置，例如：c:\data\dump\test。</p>
<p>你不能同时指定 &lt;path&gt; 和 --dir 选项，--dir也可以设置备份目录。</p>
</li>
<li><strong>
--dir：</strong><p>指定备份的目录</p>
<p>你不能同时指定 &lt;path&gt; 和 --dir 选项。</p>
</li>
</ul>
<p>接下来我们执行以下命令:</p>
<pre>
&gt;mongorestore
</pre>
<p>执行以上命令输出结果如下：</p>
<p>
<img alt="MongoDB数据恢复" src="http://www.runoob.com/wp-content/uploads/2013/12/mongorestore.png"/>
</p>
</div>