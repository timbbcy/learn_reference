<div class="article-intro" id="content">
<h1>C++ <span class="color_h1">模板</span></h1>
<p>模板是泛型编程的基础，泛型编程即以一种独立于任何特定类型的方式编写代码。</p>
<p>模板是创建泛型类或函数的蓝图或公式。库容器，比如迭代器和算法，都是泛型编程的例子，它们都使用了模板的概念。</p>
<p>每个容器都有一个单一的定义，比如 <b>向量</b>，我们可以定义许多不同类型的向量，比如 <b>vector &lt;int&gt;</b>  或 <b>vector &lt;string&gt;</b>。</p>
<p>您可以使用模板来定义函数和类，接下来让我们一起来看看如何使用。</p>
<h2>函数模板</h2>
<p>模板函数定义的一般形式如下所示：</p>
<div class="example">
<div class="example_code">
<div class="hl-main"><span class="hl-types">template</span><span class="hl-code"> &lt;</span><span class="hl-types">class</span><span class="hl-code"> </span><span class="hl-identifier">type</span><span class="hl-code">&gt; </span><span class="hl-identifier">ret</span><span class="hl-code">-</span><span class="hl-identifier">type</span><span class="hl-code"> </span><span class="hl-identifier">func</span><span class="hl-code">-</span><span class="hl-identifier">name</span><span class="hl-brackets">(</span><span class="hl-identifier">parameter</span><span class="hl-code"> </span><span class="hl-identifier">list</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-comment">// 函数的主体</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-brackets">}</span></div>
</div>
</div>
<p>在这里，type 是函数所使用的数据类型的占位符名称。这个名称可以在函数定义中使用。</p>
<p>下面是函数模板的实例，返回两个数中的最大值：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code">
<div class="hl-main"><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">iostream</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"></span><span class="hl-code">
</span><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">string</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"></span><span class="hl-code">
</span><span class="hl-reserved">using</span><span class="hl-code"> </span><span class="hl-types">namespace</span><span class="hl-code"> </span><span class="hl-identifier">std</span><span class="hl-code">;
 
</span><span class="hl-types">template</span><span class="hl-code"> &lt;</span><span class="hl-types">typename</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-code">&gt;
</span><span class="hl-types">inline</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">&amp; </span><span class="hl-identifier">Max</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">T</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">&amp; </span><span class="hl-identifier">a</span><span class="hl-code">, </span><span class="hl-identifier">T</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">&amp; </span><span class="hl-identifier">b</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">a</span><span class="hl-code"> &lt; </span><span class="hl-identifier">b</span><span class="hl-code"> ? </span><span class="hl-identifier">b</span><span class="hl-code">:</span><span class="hl-identifier">a</span><span class="hl-code">; 
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">main</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-number">39</span><span class="hl-code">;
    </span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">j</span><span class="hl-code"> = </span><span class="hl-number">20</span><span class="hl-code">;
    </span><span class="hl-identifier">cout</span><span class="hl-code"> &lt;&lt; </span><span class="hl-quotes">"</span><span class="hl-string">Max(i, j): </span><span class="hl-quotes">"</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">Max</span><span class="hl-brackets">(</span><span class="hl-identifier">i</span><span class="hl-code">, </span><span class="hl-identifier">j</span><span class="hl-brackets">)</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">endl</span><span class="hl-code">; 
 
    </span><span class="hl-types">double</span><span class="hl-code"> </span><span class="hl-identifier">f1</span><span class="hl-code"> = </span><span class="hl-number">13</span><span class="hl-number">.5</span><span class="hl-code">; 
    </span><span class="hl-types">double</span><span class="hl-code"> </span><span class="hl-identifier">f2</span><span class="hl-code"> = </span><span class="hl-number">20</span><span class="hl-number">.7</span><span class="hl-code">; 
    </span><span class="hl-identifier">cout</span><span class="hl-code"> &lt;&lt; </span><span class="hl-quotes">"</span><span class="hl-string">Max(f1, f2): </span><span class="hl-quotes">"</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">Max</span><span class="hl-brackets">(</span><span class="hl-identifier">f1</span><span class="hl-code">, </span><span class="hl-identifier">f2</span><span class="hl-brackets">)</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">endl</span><span class="hl-code">; 
 
    </span><span class="hl-identifier">string</span><span class="hl-code"> </span><span class="hl-identifier">s1</span><span class="hl-code"> = </span><span class="hl-quotes">"</span><span class="hl-string">Hello</span><span class="hl-quotes">"</span><span class="hl-code">; 
    </span><span class="hl-identifier">string</span><span class="hl-code"> </span><span class="hl-identifier">s2</span><span class="hl-code"> = </span><span class="hl-quotes">"</span><span class="hl-string">World</span><span class="hl-quotes">"</span><span class="hl-code">; 
    </span><span class="hl-identifier">cout</span><span class="hl-code"> &lt;&lt; </span><span class="hl-quotes">"</span><span class="hl-string">Max(s1, s2): </span><span class="hl-quotes">"</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">Max</span><span class="hl-brackets">(</span><span class="hl-identifier">s1</span><span class="hl-code">, </span><span class="hl-identifier">s2</span><span class="hl-brackets">)</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">endl</span><span class="hl-code">; 
 
   </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;
</span><span class="hl-brackets">}</span></div>
</div>
</div>
<p>当上面的代码被编译和执行时，它会产生下列结果：</p>
<pre>
Max(i, j): 39
Max(f1, f2): 20.7
Max(s1, s2): World
</pre>
<h2>类模板</h2>
<p>正如我们定义函数模板一样，我们也可以定义类模板。泛型类声明的一般形式如下所示：</p>
<pre>
template &lt;class type&gt; class class-name {
.
.
.
}
</pre>
<p>在这里，<b>type</b> 是占位符类型名称，可以在类被实例化的时候进行指定。您可以使用一个逗号分隔的列表来定义多个泛型数据类型。</p>
<p>下面的实例定义了类 Stack&lt;&gt;，并实现了泛型方法来对元素进行入栈出栈操作：</p>
<div class="example">
<h2 class="example">实例</h2>
<div class="example_code">
<div class="hl-main"><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">iostream</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"></span><span class="hl-code">
</span><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">vector</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"></span><span class="hl-code">
</span><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">cstdlib</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"></span><span class="hl-code">
</span><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">string</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"></span><span class="hl-code">
</span><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">stdexcept</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"></span><span class="hl-code">
</span><span class="hl-reserved">using</span><span class="hl-code"> </span><span class="hl-types">namespace</span><span class="hl-code"> </span><span class="hl-identifier">std</span><span class="hl-code">;
 
</span><span class="hl-types">template</span><span class="hl-code"> &lt;</span><span class="hl-types">class</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-code">&gt;
</span><span class="hl-types">class</span><span class="hl-code"> </span><span class="hl-identifier">Stack</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">private</span><span class="hl-code">: 
    </span><span class="hl-identifier">vector</span><span class="hl-code">&lt;</span><span class="hl-identifier">T</span><span class="hl-code">&gt; </span><span class="hl-identifier">elems</span><span class="hl-code">;     </span><span class="hl-comment">// 元素 </span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-reserved">public</span><span class="hl-code">: 
    </span><span class="hl-types">void</span><span class="hl-code"> </span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-identifier">T</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">&amp;</span><span class="hl-brackets">)</span><span class="hl-code">;  </span><span class="hl-comment">// 入栈</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-types">void</span><span class="hl-code"> </span><span class="hl-identifier">pop</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;               </span><span class="hl-comment">// 出栈</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">T</span><span class="hl-code"> </span><span class="hl-identifier">top</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">;            </span><span class="hl-comment">// 返回栈顶元素</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-types">bool</span><span class="hl-code"> </span><span class="hl-identifier">empty</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-brackets">{</span><span class="hl-code"> </span><span class="hl-comment">// 如果为空则返回真。</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">elems</span><span class="hl-code">.</span><span class="hl-identifier">empty</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">; 
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span><span class="hl-code">; 
 
</span><span class="hl-types">template</span><span class="hl-code"> &lt;</span><span class="hl-types">class</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-code">&gt;
</span><span class="hl-types">void</span><span class="hl-code"> </span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-identifier">T</span><span class="hl-code">&gt;::</span><span class="hl-identifier">push</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">T</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">&amp; </span><span class="hl-identifier">elem</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-comment">// 追加传入元素的副本</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">elems</span><span class="hl-code">.</span><span class="hl-identifier">push_back</span><span class="hl-brackets">(</span><span class="hl-identifier">elem</span><span class="hl-brackets">)</span><span class="hl-code">;    
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-types">template</span><span class="hl-code"> &lt;</span><span class="hl-types">class</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-code">&gt;
</span><span class="hl-types">void</span><span class="hl-code"> </span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-identifier">T</span><span class="hl-code">&gt;::</span><span class="hl-identifier">pop</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">elems</span><span class="hl-code">.</span><span class="hl-identifier">empty</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">throw</span><span class="hl-code"> </span><span class="hl-identifier">out_of_range</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">Stack&lt;&gt;::pop(): empty stack</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">; 
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-comment">// 删除最后一个元素</span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">elems</span><span class="hl-code">.</span><span class="hl-identifier">pop_back</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;         
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-types">template</span><span class="hl-code"> &lt;</span><span class="hl-types">class</span><span class="hl-code"> </span><span class="hl-identifier">T</span><span class="hl-code">&gt;
</span><span class="hl-identifier">T</span><span class="hl-code"> </span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-identifier">T</span><span class="hl-code">&gt;::</span><span class="hl-identifier">top</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">if</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">elems</span><span class="hl-code">.</span><span class="hl-identifier">empty</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">throw</span><span class="hl-code"> </span><span class="hl-identifier">out_of_range</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">Stack&lt;&gt;::top(): empty stack</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">; 
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-comment">// 返回最后一个元素的副本 </span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">elems</span><span class="hl-code">.</span><span class="hl-identifier">back</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;      
</span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">main</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-reserved">try</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-types">int</span><span class="hl-code">&gt;         </span><span class="hl-identifier">intStack</span><span class="hl-code">;  </span><span class="hl-comment">// int 类型的栈 </span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">Stack</span><span class="hl-code">&lt;</span><span class="hl-identifier">string</span><span class="hl-code">&gt; </span><span class="hl-identifier">stringStack</span><span class="hl-code">;    </span><span class="hl-comment">// string 类型的栈 </span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-comment">// 操作 int 类型的栈 </span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">intStack</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-number">7</span><span class="hl-brackets">)</span><span class="hl-code">; 
        </span><span class="hl-identifier">cout</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">intStack</span><span class="hl-code">.</span><span class="hl-identifier">top</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> &lt;&lt;</span><span class="hl-identifier">endl</span><span class="hl-code">; 
 
        </span><span class="hl-comment">// 操作 string 类型的栈 </span><span class="hl-comment"></span><span class="hl-code">
</span><span class="hl-identifier">stringStack</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">hello</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">; 
        </span><span class="hl-identifier">cout</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">stringStack</span><span class="hl-code">.</span><span class="hl-identifier">top</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">std</span><span class="hl-code">::</span><span class="hl-identifier">endl</span><span class="hl-code">; 
        </span><span class="hl-identifier">stringStack</span><span class="hl-code">.</span><span class="hl-identifier">pop</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">; 
        </span><span class="hl-identifier">stringStack</span><span class="hl-code">.</span><span class="hl-identifier">pop</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">; 
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-reserved">catch</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">exception</span><span class="hl-code"> </span><span class="hl-types">const</span><span class="hl-code">&amp; </span><span class="hl-identifier">ex</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
</span><span class="hl-identifier">cerr</span><span class="hl-code"> &lt;&lt; </span><span class="hl-quotes">"</span><span class="hl-string">Exception: </span><span class="hl-quotes">"</span><span class="hl-code"> &lt;&lt; </span><span class="hl-identifier">ex</span><span class="hl-code">.</span><span class="hl-identifier">what</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code"> &lt;&lt;</span><span class="hl-identifier">endl</span><span class="hl-code">; 
        </span><span class="hl-reserved">return</span><span class="hl-code"> -</span><span class="hl-number">1</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
</span><span class="hl-brackets">}</span></div>
</div>
</div>
<p>当上面的代码被编译和执行时，它会产生下列结果：</p>
<pre>
7
hello
Exception: Stack&lt;&gt;::pop(): empty stack
</pre>
</div>